<!-- PAGE TITLE -->
<section class="page-title-section bg-img cover-background"
         data-overlay-dark="6"
         data-background="https://images.unsplash.com/photo-1523240795612-9a054b0db644?auto=format&fit=crop&w=1600&q=80"
         style="background-image: url('https://images.unsplash.com/photo-1523240795612-9a054b0db644?auto=format&fit=crop&w=1600&q=80');">
    <div class="container">
        <div class="row text-center">
            <div class="col-md-12">
                <h1 class="text-white">Detalles del Curso</h1>
            </div>
            <div class="col-md-12">
                <ul class="breadcrumb justify-content-center">
                    <li><a routerLink="/">Inicio</a></li>
                    <li><span>Detalles del Curso</span></li>
                </ul>
            </div>
        </div>
    </div>
</section>

<!-- Loading state -->
<div *ngIf="loading" class="container py-5">
    <div class="row justify-content-center">
        <div class="col-md-6 text-center">
            <div class="spinner-border text-primary" role="status">
                <span class="visually-hidden">Cargando...</span>
            </div>
            <p class="mt-3">Cargando detalles del curso...</p>
        </div>
    </div>
</div>

<!-- Error state -->
<div *ngIf="error && !loading" class="container py-5">
    <div class="row justify-content-center">
        <div class="col-md-6 text-center">
            <i class="fas fa-exclamation-triangle display-1 text-warning mb-3"></i>
            <h3>Error al cargar el curso</h3>
            <p>{{error}}</p>
            <button class="btn btn-primary" (click)="loadCourseDetails()">Intentar nuevamente</button>
        </div>
    </div>
</div>

<!-- COURSE DETAILS -->
<section class="courses" *ngIf="!loading && !error && course">
    <div class="container">
        <div class="row">
            <div class="col-md-12 col-lg-8 mb-2-9 mb-lg-0">
                <div class="row">
                    <div class="col-md-12 mb-1-6 mb-md-1-9">
                        <div class="courses-info mb-4">

                            <div class="bg-light rounded py-4 px-4 mb-3">
                                <div class="section-heading mb-0 text-start">
                                    <span class="sub-title">{{course.category}}</span>
                                </div>
                                <h2 class="h1 mb-0">{{course.title}}</h2>
                            </div>

                            <div class="course-meta bg-primary rounded py-4 px-4 overflow-hidden">

                                <div class="item dates">
                                    <h4 class="display-29 display-xl-28 font-weight-800 mb-1 text-white">Duración</h4>
                                    <span class="display-30 font-weight-600 text-white">{{course.duration}}</span>
                                </div>

                            </div>

                        </div>
                        <figure class="mb-0">
                            <img class="border-radius-5 w-100" [src]="course.imageUrl" [alt]="course.title">
                        </figure>
                    </div>

                    <div class="col-md-12 mb-1-6 mb-md-2-9">
                        <div class="horizontaltab tab-style1">
                            <ul class="resp-tabs-list hor_1">
                                <li><span class="display-block xs-display-inline-block">Descripción</span></li>
                                <!-- <li><span class="display-block xs-display-inline-block">Instructor</span></li> -->
                                <li><span class="display-block xs-display-inline-block">Contenido</span></li>
                                <!-- <li><span class="display-block xs-display-inline-block">Reseñas</span></li> -->
                            </ul>
                            <div class="resp-tabs-container hor_1">
                                <!-- Descripción Tab -->
                                <div>
                                    <div class="row">
                                        <div class="col-md-12 mb-1-6 mb-lg-1-9">
                                            <h3>Descripción del Curso</h3>
                                            <p class="alt-font font-weight-500 text-color mb-0">{{course.description}}</p>
                                        </div>
                                        <div class="col-md-12 mb-1-6 mb-lg-1-9" *ngIf="getPrerequisitesList().length > 0">
                                            <h3>Requisitos</h3>
                                            <ul class="course-detail-list">
                                                <li *ngFor="let req of getPrerequisitesList()">
                                                    <i class="ti-check-box vertical-align-middle text-secondary pe-2"></i>{{req}}
                                                </li>
                                            </ul>
                                        </div>
                                        <div class="col-md-12" *ngIf="getObjectivesList().length > 0">
                                            <h3>Objetivos</h3>
                                            <ul class="course-detail-list">
                                                <li *ngFor="let obj of getObjectivesList()">
                                                    <i class="ti-check-box vertical-align-middle text-secondary pe-2"></i>{{obj}}
                                                </li>
                                            </ul>
                                        </div>
                                    </div>
                                </div>

                                <!-- INSTRUCTOR TAB - ELIMINADO TEMPORALMENTE
                                <div>
                                    <div class="row mb-1-6 mb-lg-1-9 mb-xl-2-5">
                                        <div class="col-md-12">
                                            <h3>Información del Instructor</h3>
                                            <p class="alt-font font-weight-500 text-color mb-4">{{course.instructor}} es un profesional con amplia experiencia en el área de {{course.category}}, especializado en brindar formación de calidad y actualizada según los estándares internacionales.</p>
                                        </div>
                                    </div>
                                    <div class="row">
                                        <div class="col-md-6 mb-1-6 mb-sm-1-9 mb-lg-0">
                                            <div class="team-style1 text-center">
                                                <img src="https://images.unsplash.com/photo-1507003211169-0a1dd7228f2d?auto=format&fit=crop&w=300&q=80" class="border-radius-5" [alt]="course.instructor">
                                                <div class="team-info">
                                                    <h3 class="text-primary mb-1 h4">{{course.instructor}}</h3>
                                                    <span class="font-weight-600 text-secondary">Especialista en {{course.category}}</span>
                                                </div>
                                            </div>
                                        </div>
                                        <div class="col-md-6">
                                            <h4>Experiencia y Credenciales</h4>
                                            <ul class="course-detail-list">
                                                <li><i class="ti-check-box vertical-align-middle text-secondary pe-2"></i>Más de 10 años de experiencia profesional</li>
                                                <li><i class="ti-check-box vertical-align-middle text-secondary pe-2"></i>Certificaciones internacionales</li>
                                                <li><i class="ti-check-box vertical-align-middle text-secondary pe-2"></i>Docente universitario</li>
                                                <li><i class="ti-check-box vertical-align-middle text-secondary pe-2"></i>Publicaciones en revistas especializadas</li>
                                            </ul>
                                        </div>
                                    </div>
                                </div>
                                -->

                                <!-- Contenido Tab -->
                                <div>
                                    <div class="row">
                                        <div class="col-lg-12">
                                            <div *ngIf="getOrganizedContents().length > 0">
                                                <div class="content-list">
                                                    <div class="content-item border rounded p-3 mb-3" *ngFor="let module of getOrganizedContents()">
                                                        <div *ngFor="let content of module.contents; let isLast = last">
                                                            <div class="content-header mb-2">
                                                                <h5 class="mb-1 text-primary">{{content.title}}</h5>
                                                                <div class="content-meta d-flex align-items-center text-muted small">
                                                                    <span *ngIf="content.duration" class="me-3">
                                                                        <i class="fas fa-clock me-1"></i>{{content.duration}}
                                                                    </span>
                                                                </div>
                                                            </div>
                                                            <div class="content-description" *ngIf="content.description">
                                                                <p class="text-muted mb-0">{{content.description}}</p>
                                                            </div>
                                                            <hr *ngIf="!isLast" class="my-3">
                                                        </div>
                                                    </div>
                                                </div>
                                            </div>
                                        </div>
                                    </div>
                                </div>

                                <!-- RESEÑAS Y COMENTARIOS TAB - COMENTADO TEMPORALMENTE
                                <div>
                                    <div class="row mb-1-6 mb-lg-1-9 mb-xl-2-5">
                                        <div class="col-md-12">
                                            <h4 class="display-27 display-md-25 display-xl-20 font-weight-800 mb-1-6 text-capitalize">Reseñas</h4>
                                            <div class="row">
                                                <div class="col-md-4">
                                                    <div class="bg-very-light-gray text-center">
                                                        <div class="rating-box">
                                                            <span class="rating-number">5</span>
                                                            <ul class="list-unstyled">
                                                                <li><i class="fa fa-star"></i></li>
                                                                <li><i class="fa fa-star"></i></li>
                                                                <li><i class="fa fa-star"></i></li>
                                                                <li><i class="fa fa-star"></i></li>
                                                                <li><i class="fa fa-star"></i></li>
                                                            </ul>
                                                            <span class="display-30 text-color font-weight-800">{{course.reviews?.length || 0}} Calificaciones</span>
                                                        </div>
                                                    </div>
                                                </div>
                                                <div class="col-md-8">
                                                    <div class="row">
                                                        <div class="col-sm-12 mb-3">
                                                            <div class="progress-text">
                                                                <div class="row">
                                                                    <div class="col-7">5 Estrellas</div>
                                                                    <div class="col-5 text-end">95%</div>
                                                                </div>
                                                            </div>
                                                            <div class="progress progress-medium">
                                                                <div class="animated custom-bar progress-bar slideInLeft" style="width: 95%;" aria-valuemax="100" aria-valuemin="0" aria-valuenow="95" role="progressbar"></div>
                                                            </div>
                                                        </div>
                                                        <div class="col-sm-12 mb-3">
                                                            <div class="progress-text">
                                                                <div class="row">
                                                                    <div class="col-7">4 Estrellas</div>
                                                                    <div class="col-5 text-end">5%</div>
                                                                </div>
                                                            </div>
                                                            <div class="progress progress-medium">
                                                                <div class="animated custom-bar progress-bar slideInLeft" style="width: 5%;" aria-valuemax="100" aria-valuemin="0" aria-valuenow="5" role="progressbar"></div>
                                                            </div>
                                                        </div>
                                                    </div>
                                                </div>
                                            </div>
                                        </div>
                                    </div>
                                    <div class="row mb-1-6 mb-lg-1-9 mb-xl-2-5">
                                        <h4 class="display-27 display-md-25 display-lg-24 display-xl-20 font-weight-800 mb-1-6 text-capitalize">Comentarios</h4>
                                        <div class="col-lg-12">
                                            <div class="comment-box" *ngFor="let review of course.reviews">
                                                <div class="author-thumb">
                                                    <img class="border-radius-50" src="https://images.unsplash.com/photo-1507003211169-0a1dd7228f2d?auto=format&fit=crop&w=150&q=80" [alt]="review.author">
                                                </div>
                                                <div class="ps-10 ps-md-11">
                                                    <div class="mb-3">
                                                        <h6 class="display-29 display-lg-28 font-weight-800"><a href="#!">{{review.author}}</a></h6>
                                                        <div class="review-rating">
                                                            <i class="fas fa-star" *ngFor="let star of getStarArray(review.rating)"></i>
                                                        </div>
                                                        <small class="text-muted">{{review.date}}</small>
                                                    </div>
                                                    <p class="mb-3 display-30 display-md-29 alt-font text-color font-weight-500">{{review.comment}}</p>
                                                </div>
                                            </div>
                                        </div>
                                    </div>
                                </div>
                                -->
                            </div>
                        </div>
                    </div>
                </div>
            </div>

            <!-- Sidebar -->
            <div class="col-md-12 col-lg-4">
                <div class="ps-lg-1-6 ps-xl-1-9">
                    <div class="sidebar">
                        <div class="widget">
                            <div class="widget-title">
                                <h3>Detalles del Curso</h3>
                            </div>
                            <ul class="course-list">
                                <li><span><i class="ti-time pe-2"></i>Duración</span>{{getTotalDuration()}}</li>
                                <li><span><i class="ti-eye pe-2"></i>Créditos</span>{{course.credits || 0}}</li>
                                <li *ngIf="getTotalLessons() > 0"><span><i class="ti-files pe-2"></i>Contenidos</span>{{getTotalLessons()}}</li>
                                <li><span><i class="ti-user pe-2"></i>Max. Estudiantes</span>{{course.maxStudents || 'Ilimitado'}}</li>
                                <li><span><i class="ti-medall pe-2"></i>Certificado</span>Sí</li>
                                <li><span><i class="ti-menu-alt pe-2"></i>Estado</span>{{course.status === 'active' ? 'Activo' : 'Inactivo'}}</li>
                                <li><span><i class="ti-stats-up pe-2"></i>Tipo</span>{{course.type}}</li>
                                <li><span><i class="ti-world pe-2"></i>Idioma</span>Español</li>
                                <li><span><i class="ti-money pe-2"></i>Precio</span>{{course.price}}</li>
                            </ul>
                            <div class="text-center mt-4">
                                <button class="btn btn-primary btn-lg w-100 mb-3" (click)="enrollViaWhatsApp()">
                                    <i class="fab fa-whatsapp me-2"></i>Inscribirse Ahora
                                </button>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>
</section>
